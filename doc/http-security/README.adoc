= HTTP Security Validation Overview
:toc: left
:toclevels: 2
:icons: font

== Overview

Documentation for HTTP/URL path traversal security validation in cui-http.


== Document Index

=== Requirements and Specifications

xref:Requirements.adoc[Requirements Overview]::
Master requirements document linking functional and security requirements with traceability matrix.

xref:functional-requirements.adoc[Functional Requirements]::
Complete functional requirements for HTTP security validation system with detailed acceptance criteria.

xref:security-requirements.adoc[Security Requirements]::
Security-specific requirements addressing OWASP Top 10, CVE patterns, and threat mitigation strategies.

xref:specification/specification.adoc[Architecture Specification]::
HTTP/URL path traversal security architecture leveraging Java 21+ built-in types with performance optimization strategies.

xref:specification/pipeline-architecture-standards.adoc[Pipeline Architecture Standards]::
Detailed standards for validation pipeline selection, configuration, and implementation patterns.

=== Security Analysis

xref:analysis/owasp-best-practices.adoc[OWASP Best Practices]::
OWASP-recommended prevention strategies, validation techniques, and security patterns for path traversal prevention.

xref:analysis/cve-analysis.adoc[CVE Analysis and Breach Studies]::
Detailed analysis of critical CVEs from 2019-2024 and real-world breach case studies demonstrating exploitation patterns and impacts.

xref:analysis/http1-vulnerabilities-analysis.adoc[HTTP/1.x Protocol Vulnerabilities]::
Comprehensive analysis of HTTP/1.x protocol vulnerabilities including request smuggling (CL.TE, TE.CL, CL.0), Expect header desync attacks, parser differentials, and upstream connection reuse exploits. Based on PortSwigger research "HTTP/1 Must Die".

xref:analysis/cookie-chaos-analysis.adoc[Cookie Security Analysis]::
In-depth analysis of RFC 6265bis Cookie Chaos vulnerabilities, prefix validation issues, domain security, and cookie injection attacks. Includes defense strategies and validation requirements.

=== Testing and Validation

xref:specification/testing.adoc[Testing Framework]::
Complete testing framework specification including CVE-based test vectors, encoding matrices, and automated security validation.

== Quick Start

For developers implementing path traversal security:

1. Review xref:analysis/owasp-best-practices.adoc#_core_prevention_principles[Core Prevention Principles]
2. Understand xref:analysis/cve-analysis.adoc#_attack_pattern_evolution[Attack Pattern Evolution]
3. Implement using xref:specification/specification.adoc#_system_architecture[System Architecture]
4. Validate with xref:specification/testing.adoc#_test_data_categories[Test Data Categories]

== HTTP/URL Standards Reference

=== RFC Compliance

The implementation follows these HTTP and URL standards:

* **RFC 3986** - Uniform Resource Identifier (URI): Generic Syntax
* **RFC 7230** - Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing
* **RFC 8941** - Structured Field Values for HTTP
* **RFC 6265** - HTTP State Management Mechanism (Cookies)

=== URL Component Validation

According to RFC 3986, valid URL path components must adhere to:

* **Unreserved Characters**: `A-Z`, `a-z`, `0-9`, `-`, `.`, `_`, `~`
* **Reserved Characters**: `:`, `/`, `?`, `#`, `[`, `]`, `@`, `!`, `$`, `&`, `'`, `(`, `)`, `*`, `+`, `,`, `;`, `=`
* **Percent-Encoding**: Non-ASCII and special characters must be percent-encoded

=== HTTP Parameter Validation

Valid HTTP parameter names (RFC 7230):

* Must start with alphanumeric character
* Can contain: `A-Z`, `a-z`, `0-9`, `-`, `_`
* Case-insensitive in headers, case-sensitive in query parameters
* Maximum length considerations for security

== Key Security Patterns

=== URL Path Traversal Prevention

Primary attack vectors in HTTP/URL contexts:

* **Percent-Encoded Traversal**: `%2e%2e%2f` → `../`
* **Double Encoding**: `%252e%252e%252f` → `%2e%2e%2f` → `../`
* **UTF-8 Overlong**: Malformed UTF-8 encoding attacks
* **HTTP Protocol Mixed Encoding**: Combining URL encoding schemes

=== Validation Pipeline

[source]
----
Input → Decode → Normalize → Validate → Verify → Output
----

Each stage must handle:

* HTTP protocol-layer encoding only (URL encoding, UTF-8, Unicode normalization)
* Platform-specific separators
* Context-aware validation
* Performance optimization

**Architectural Boundary**: Application-layer encodings (HTML entities, JavaScript escapes, Base64) handled by higher layers.


== Contributing

When updating this documentation suite:

1. Maintain cross-references between documents
2. Update this README index when adding new documents  
3. Follow AsciiDoc formatting standards
4. Include RFC references for HTTP/URL standards compliance
5. Focus on HTTP/URL-specific security patterns

== References

=== Standards

* xref:https://www.rfc-editor.org/rfc/rfc3986[RFC 3986 - URI Generic Syntax]
* xref:https://www.rfc-editor.org/rfc/rfc7230[RFC 7230 - HTTP/1.1 Message Syntax]
* xref:https://www.rfc-editor.org/rfc/rfc8941[RFC 8941 - Structured Field Values]

=== Security Resources

* xref:https://owasp.org/www-community/attacks/Path_Traversal[OWASP Path Traversal]
* xref:https://cwe.mitre.org/data/definitions/22.html[CWE-22: Path Traversal]
* xref:https://portswigger.net/web-security/file-path-traversal[PortSwigger Web Security]

