= HTTP Security Validation Framework
:toc: left
:toclevels: 3
:toc-title: Table of Contents
:sectnums:
:source-highlighter: highlight.js

toc::[]

== Maven Coordinates

[source,xml]
----
<dependency>
    <groupId>de.cuioss</groupId>
    <artifactId>cui-http</artifactId>
</dependency>
----

== Overview

Validation framework for HTTP components (paths, parameters, headers, bodies) with attack pattern detection.

=== Core Interface

`HttpSecurityValidator`: Functional interface following "String in, String out, throws on violation" pattern. See `de.cuioss.http.security.core.HttpSecurityValidator`.

== Validation Pipelines

=== URLPathValidationPipeline

Validates path-only attacks, directory traversal patterns, and CVE exploits. Processes input through sequential validation stages to detect path-based security threats.

See `de.cuioss.http.security.pipeline.URLPathValidationPipeline`.

=== HTTPHeaderValidationPipeline

Validates HTTP header content, detecting header injection attacks and CRLF (Carriage Return Line Feed) injection attempts that could manipulate HTTP response headers.

See `de.cuioss.http.security.pipeline.HTTPHeaderValidationPipeline`.

=== URLParameterValidationPipeline

Validates query parameters and form data, ensuring parameter values don't contain malicious patterns or injection attempts.

See `de.cuioss.http.security.pipeline.URLParameterValidationPipeline`.

== Validation Stages

* `DecodingStage` - URL percent-decoding and UTF-8 overlong encoding detection
* `NormalizationStage` - Unicode normalization for consistent character representation
* `CharacterValidationStage` - Invalid and dangerous character detection
* `LengthValidationStage` - Length limit enforcement to prevent buffer overflow attacks
* `PatternMatchingStage` - Attack pattern detection using configured security rules

== Configuration

`SecurityConfigurationBuilder` provides configuration with sensible defaults:

* Path length: 4096 characters
* Parameter count: 100
* Header count: 50
* Cookie count: 20
* Body size: 5MB

== Usage Example

[source,java]
----
// Create pipeline with configuration
SecurityConfiguration config = SecurityConfiguration.builder()
    .maxPathLength(2048)
    .allowPathTraversal(false)
    .build();

SecurityEventCounter counter = new SecurityEventCounter();
URLPathValidationPipeline pipeline = new URLPathValidationPipeline(
    config,
    counter
);

// Validate input
try {
    String validated = pipeline.validate("/api/users/123");
    // Use validated path
} catch (UrlSecurityException e) {
    log.warn("Security violation: {}", e.getFailureType());
}
----

[source,java]
----
// Use PipelineFactory for type-based selection
SecurityConfiguration config = SecurityConfiguration.builder().build();
SecurityEventCounter counter = new SecurityEventCounter();
HttpSecurityValidator validator = PipelineFactory.createPipeline(
    ValidationType.URL_PATH, config, counter);
String validated = validator.validate(userInput);
----


== Pipeline Selection Rules

See xref:../doc/http-security/specification/pipeline-architecture-standards.adoc[Pipeline Architecture Standards] for detailed selection criteria.

== Related Documentation

* xref:../doc/http-security/README.adoc[Complete HTTP Security Documentation]
* xref:../doc/http-security/specification/specification.adoc[Architecture Specification]
* xref:../doc/http-security/specification/testing.adoc[Testing Framework]