= HTTP Security Validation Framework
:toc: macro
:toclevels: 2
:toc-title: Table of Contents

toc::[]

== Maven Coordinates

[source, xml]
----
<dependency>
    <groupId>de.cuioss</groupId>
    <artifactId>cui-http</artifactId>
</dependency>
----

== Overview

Validation framework for HTTP components (paths, parameters, headers, bodies) with attack pattern detection.

=== Core Interface

link:../src/main/java/de/cuioss/http/security/core/HttpSecurityValidator.java[HttpSecurityValidator]: Functional interface following "String in, String out, throws on violation" pattern.

== Validation Pipelines

=== link:../src/main/java/de/cuioss/http/security/pipeline/URLPathValidationPipeline.java[URLPathValidationPipeline]

For path-only attacks, directory traversal, CVE exploits. Sequential validation through configured stages.

=== link:../src/main/java/de/cuioss/http/security/pipeline/HTTPBodyValidationPipeline.java[HTTPBodyValidationPipeline]

For full URLs with protocols, XSS, script injection.

=== link:../src/main/java/de/cuioss/http/security/pipeline/HTTPHeaderValidationPipeline.java[HTTPHeaderValidationPipeline]

For header injection, CRLF attacks.

=== link:../src/main/java/de/cuioss/http/security/pipeline/URLParameterValidationPipeline.java[URLParameterValidationPipeline]

For query parameters, form data validation.

== Validation Stages

* link:../src/main/java/de/cuioss/http/security/validation/DecodingStage.java[DecodingStage] - URL decoding, UTF-8 overlong detection
* link:../src/main/java/de/cuioss/http/security/validation/NormalizationStage.java[NormalizationStage] - Unicode normalization
* link:../src/main/java/de/cuioss/http/security/validation/CharacterValidationStage.java[CharacterValidationStage] - Character validation
* link:../src/main/java/de/cuioss/http/security/validation/LengthValidationStage.java[LengthValidationStage] - Length limits
* link:../src/main/java/de/cuioss/http/security/validation/PatternMatchingStage.java[PatternMatchingStage] - Attack pattern detection

== Configuration

link:../src/main/java/de/cuioss/http/security/config/SecurityConfigurationBuilder.java[SecurityConfigurationBuilder] provides configuration with sensible defaults:

* Path length: 4096 characters
* Parameter count: 100
* Header count: 50
* Cookie count: 20
* Body size: 5MB

== Usage Example

[source,java]
----
// Create pipeline with configuration
SecurityConfiguration config = SecurityConfiguration.builder()
    .maxPathLength(2048)
    .allowPathTraversal(false)
    .build();

URLPathValidationPipeline pipeline = new URLPathValidationPipeline(
    config,
    SecurityEventCounter.getInstance()
);

// Validate input
try {
    String validated = pipeline.validate("/api/users/123");
    // Use validated path
} catch (UrlSecurityException e) {
    log.warn("Security violation: {}", e.getFailureType());
}
----

[source,java]
----
// Use PipelineFactory for type-based selection
HttpSecurityValidator validator = PipelineFactory.createValidator(ValidationType.URL_PATH);
String validated = validator.validate(userInput);
----


== Pipeline Selection Rules

See link:../doc/http-security/specification/pipeline-architecture-standards.adoc[Pipeline Architecture Standards] for detailed selection criteria.

== Related Documentation

* link:../doc/http-security/README.adoc[Complete HTTP Security Documentation]
* link:../doc/http-security/specification/specification.adoc[Architecture Specification]
* link:../doc/http-security/specification/testing.adoc[Testing Framework]